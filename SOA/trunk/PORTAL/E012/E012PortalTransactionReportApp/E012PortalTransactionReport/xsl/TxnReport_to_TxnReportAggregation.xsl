<?xml version="1.0" encoding="UTF-8" ?>
<?oracle-xsl-mapper <!-- SPECIFICATION OF MAP SOURCES AND TARGETS, DO NOT MODIFY. -->
  <mapSources>
    <source type="WSDL">
      <schema location="../GenerateTransactionReport.wsdl"/>
      <rootElement name="TransactionReportResponse" namespace="http://www.statoilfuelretail.com/integration/engage/E012PortalTransactionReportABO"/>
    </source>
    <source type="WSDL">
      <schema location="../GenerateTransactionReport.wsdl"/>
      <rootElement name="TransactionReportInput" namespace="http://www.statoilfuelretail.com/integration/engage/E012PortalTransactionReportABO"/>
      <param name="transactionReportInput" />
    </source>
  </mapSources>
  <mapTargets>
    <target type="WSDL">
      <schema location="../GenerateTransactionReport.wsdl"/>
      <rootElement name="TransactionReportResponse" namespace="http://www.statoilfuelretail.com/integration/engage/E012PortalTransactionReportABO"/>
    </target>
  </mapTargets>
  <!-- GENERATED BY ORACLE XSL MAPPER 11.1.1.6.0(build 111214.0600.1553) AT [MON SEP 01 17:40:47 IST 2014]. -->
?>
<xsl:stylesheet version="1.0"
                xmlns:bpws="http://schemas.xmlsoap.org/ws/2003/03/business-process/"
                xmlns:xp20="http://www.oracle.com/XSL/Transform/java/oracle.tip.pc.services.functions.Xpath20"
                xmlns:mhdr="http://www.oracle.com/XSL/Transform/java/oracle.tip.mediator.service.common.functions.MediatorExtnFunction"
                xmlns:bpel="http://docs.oasis-open.org/wsbpel/2.0/process/executable"
                xmlns:oraext="http://www.oracle.com/XSL/Transform/java/oracle.tip.pc.services.functions.ExtFunc"
                xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                xmlns:dvm="http://www.oracle.com/XSL/Transform/java/oracle.tip.dvm.LookupValue"
                xmlns:hwf="http://xmlns.oracle.com/bpel/workflow/xpath"
                xmlns:ns2="http://www.lntinfotech.com/integration/SOARuleEngineNotification"
                xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                xmlns:med="http://schemas.oracle.com/mediator/xpath"
                xmlns:ids="http://xmlns.oracle.com/bpel/services/IdentityService/xpath"
                xmlns:bpm="http://xmlns.oracle.com/bpmn20/extensions"
                xmlns:client="http://xmlns.oracle.com/E012PortalTransactionReportApp/E012PortalTransactionReport/GenerateTransactionReport"
                xmlns:xdk="http://schemas.oracle.com/bpel/extension/xpath/function/xdk"
                xmlns:xref="http://www.oracle.com/XSL/Transform/java/oracle.tip.xref.xpath.XRefXPathFunctions"
                xmlns:plnk="http://schemas.xmlsoap.org/ws/2003/05/partner-link/"
                xmlns:xsd="http://www.w3.org/2001/XMLSchema"
                xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/"
                xmlns:ora="http://schemas.oracle.com/xpath/extension"
                xmlns:socket="http://www.oracle.com/XSL/Transform/java/oracle.tip.adapter.socket.ProtocolTranslator"
                xmlns:ns1="http://www.statoilfuelretail.com/integration/engage/E012PortalTransactionReportABO"
                xmlns:ldap="http://schemas.oracle.com/xpath/extension/ldap"
                exclude-result-prefixes="xsi xsl ns2 client plnk xsd wsdl ns1 bpws xp20 mhdr bpel oraext dvm hwf med ids bpm xdk xref ora socket ldap">
  <xsl:param name="transactionReportInput"/>
  <xsl:template match="/">
    <ns1:TransactionReportResponse>
      <Header>
        <Line>
          <xsl:value-of select="concat('Company : ',$transactionReportInput/ns1:TransactionReportInput/Partner)"/>
        </Line>
        <Line>
          <xsl:value-of select="concat('Account : ',$transactionReportInput/ns1:TransactionReportInput/Account)"/>
        </Line>
        <Line>
          <xsl:value-of select="concat('Type : ',$transactionReportInput/ns1:TransactionReportInput/Type)"/>
        </Line>
        <Line>
          <xsl:value-of select="concat('Report : ',$transactionReportInput/ns1:TransactionReportInput/ReportType)"/>
        </Line>
        <Line>
          <xsl:value-of select="concat('Period : ',$transactionReportInput/ns1:TransactionReportInput/TransactionDateFrom, ' to ',$transactionReportInput/ns1:TransactionReportInput/TransactionDateTo)"/>
        </Line>
        <!-- Default part begins-->
        <Line>
          <xsl:text disable-output-escaping="no"></xsl:text>
        </Line>
        <Line>
          <xsl:text disable-output-escaping="no"></xsl:text>
        </Line>
        <Line>
          <xsl:text disable-output-escaping="no">Please note that international transactions are not yet visible in the portal. In some cases; it may take 2 days before national transactions is shown.</xsl:text>
        </Line>
        <Line>
          <xsl:text disable-output-escaping="no"></xsl:text>
        </Line>
        <Line>
          <xsl:text disable-output-escaping="no">Note: All prices are in DKK ...</xsl:text>
        </Line>
        <Line>
          <xsl:text disable-output-escaping="no"></xsl:text>
        </Line>
      </Header>
      <Collection>
      <xsl:for-each select="/ns1:TransactionReportResponse/TransactionData">
        <TransactionData>
          <Date>
            <xsl:value-of select="Date"/>
          </Date>
          <Account>
            <xsl:value-of select="Account"/>
          </Account>
          <CardGroup>
            <xsl:value-of select="CardGroup"/>
          </CardGroup>
          <Card>
            <xsl:value-of select="Card"/>
          </Card>
          <CardTextLine2>
            <xsl:value-of select="CardTextLine2"/>
          </CardTextLine2>
          <VehicleNo>
            <xsl:value-of select="VehicleNo"/>
          </VehicleNo>
          <InternalName>
            <xsl:value-of select="InternalName"/>
          </InternalName>
          <DriverNumber>
            <xsl:value-of select="DriverNumber"/>
          </DriverNumber>
          <DriverName>
            <xsl:value-of select="DriverName"/>
          </DriverName>
          <Station>
            <xsl:value-of select="Station"/>
          </Station>
          <Country>
            <xsl:value-of select="Country"/>
          </Country>
          <Product>
            <xsl:value-of select="Product"/>
          </Product>
          <Vol>
            <xsl:value-of select="Vol"/>
          </Vol>
          <UnitOfMeasure>
            <xsl:value-of select="UnitOfMeasure"/>
          </UnitOfMeasure>
          <Currency>
            <xsl:value-of select="Currency"/>
          </Currency>
          <ForeginUnitPrice>
            <xsl:value-of select="ForeginUnitPrice"/>
          </ForeginUnitPrice>
          <ForeginGrossAmount>
            <xsl:value-of select="ForeginGrossAmount"/>
          </ForeginGrossAmount>
          <DiscountedPrice>
            <xsl:value-of select="DiscountedPrice"/>
          </DiscountedPrice>
          <TotalAmount>
            <xsl:value-of select="TotalAmount"/>
          </TotalAmount>
          <Vat>
            <xsl:value-of select="Vat"/>
          </Vat>
          <Net>
            <xsl:value-of select="Net"/>
          </Net>
          <InvoiceNo>
            <xsl:value-of select="InvoiceNo"/>
          </InvoiceNo>
          <Odometer>
            <xsl:value-of select="Odometer"/>
          </Odometer>
          <TotalKM>
            <xsl:value-of select="TotalKM"/>
          </TotalKM>
          <KMperL>
            <xsl:value-of select="KMperL"/>
          </KMperL>
          <Lper100KM>
            <xsl:value-of select="Lper100KM"/>
          </Lper100KM>
        </TransactionData>
      </xsl:for-each>
       <TransactionData>
        <xsl:attribute name="aggregation">
          <xsl:text disable-output-escaping="no">Total</xsl:text>
        </xsl:attribute>
        <Date>
          <xsl:text disable-output-escaping="no"></xsl:text>
        </Date>
        <Account>
          <xsl:text disable-output-escaping="no"></xsl:text>
        </Account>
        <CardGroup>
          <xsl:text disable-output-escaping="no"></xsl:text>
        </CardGroup>
        <Card>
          <xsl:text disable-output-escaping="no"></xsl:text>
        </Card>
        <CardTextLine2>
          <xsl:text disable-output-escaping="no"></xsl:text>
        </CardTextLine2>
        <VehicleNo>
          <xsl:text disable-output-escaping="no"></xsl:text>
        </VehicleNo>
        <InternalName>
          <xsl:text disable-output-escaping="no"></xsl:text>
        </InternalName>
        <DriverNumber>
          <xsl:text disable-output-escaping="no"></xsl:text>
        </DriverNumber>
        <DriverName>
          <xsl:text disable-output-escaping="no"></xsl:text>
        </DriverName>
        <Station>
          <xsl:text disable-output-escaping="no"></xsl:text>
        </Station>
        <Country>
          <xsl:text disable-output-escaping="no"></xsl:text>
        </Country>
        <Product>
          <xsl:text disable-output-escaping="no"></xsl:text>
        </Product>
        <Vol>
          <xsl:text disable-output-escaping="no"></xsl:text>
        </Vol>
        <UnitOfMeasure>
          <xsl:text disable-output-escaping="no"></xsl:text>
        </UnitOfMeasure>
        <Currency>
          <xsl:text disable-output-escaping="no"></xsl:text>
        </Currency>
        <ForeginUnitPrice>
          <xsl:text disable-output-escaping="no"></xsl:text>
        </ForeginUnitPrice>
        <ForeginGrossAmount>
          <xsl:text disable-output-escaping="no"></xsl:text>
        </ForeginGrossAmount>
        <DiscountedPrice>
          <xsl:text disable-output-escaping="no"></xsl:text>
        </DiscountedPrice>
        <TotalAmount>
          <xsl:text disable-output-escaping="no"></xsl:text>
        </TotalAmount>
        <Vat>
          <xsl:text disable-output-escaping="no"></xsl:text>
        </Vat>
        <Net>
          <xsl:text disable-output-escaping="no"></xsl:text>
        </Net>
        <InvoiceNo>
          <xsl:text disable-output-escaping="no"></xsl:text>
        </InvoiceNo>
        <Odometer>
          <xsl:text disable-output-escaping="no"></xsl:text>
        </Odometer>
        <!--TotalKM>
          <xsl:value-of select="sum(/ns1:TransactionReportResponse/TransactionData/TotalKM)"/>
        </TotalKM>
        <KMperL>
          <xsl:value-of select="sum(/ns1:TransactionReportResponse/TransactionData/KMperL)"/>
        </KMperL>
        <Lper100KM>
          <xsl:value-of select="sum(/ns1:TransactionReportResponse/TransactionData/Lper100KM)"/>
        </Lper100KM-->
        <TotalKM>
          <xsl:value-of select="string(round((sum(/ns1:TransactionReportResponse/TransactionData/TotalKM))*100) div 100)"/>
        </TotalKM>
        <KMperL>
          <xsl:value-of select="string(round((sum(/ns1:TransactionReportResponse/TransactionData/KMperL))*100) div 100)"/>
        </KMperL>
        <Lper100KM>
          <xsl:value-of select="string(round((sum(/ns1:TransactionReportResponse/TransactionData/Lper100KM))*100) div 100)"/>
        </Lper100KM>
      </TransactionData>
      </Collection>
      <Trailer>
      <Line>
          <xsl:text disable-output-escaping="no"></xsl:text>
        </Line>
        <Line>
          <xsl:text disable-output-escaping="no"></xsl:text>
        </Line>
        <Line>
          <xsl:text disable-output-escaping="no">***Report Generated by SOA Rule Engine***</xsl:text>
        </Line>
        <Line>
          <xsl:text disable-output-escaping="no"></xsl:text>
        </Line>
      </Trailer>
    </ns1:TransactionReportResponse>
  </xsl:template>
</xsl:stylesheet>
