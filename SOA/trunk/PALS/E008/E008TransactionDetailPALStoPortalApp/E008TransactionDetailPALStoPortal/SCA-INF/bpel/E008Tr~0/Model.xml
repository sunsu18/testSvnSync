<?xml version="1.0" encoding="UTF-8"?>
<process name="E008TransactionDetailPALStoPortalBPEL" targetNamespace="http://xmlns.oracle.com/E008TransactionDetailPALStoPortalApp/E008TransactionDetailPALStoPortal/E008TransactionDetailPALStoPortalBPEL" xmlns="http://schemas.xmlsoap.org/ws/2003/03/business-process/" xmlns:client="http://xmlns.oracle.com/E008TransactionDetailPALStoPortalApp/E008TransactionDetailPALStoPortal/E008TransactionDetailPALStoPortalBPEL" xmlns:ora="http://schemas.oracle.com/xpath/extension" xmlns:bpws="http://schemas.xmlsoap.org/ws/2003/03/business-process/" xmlns:ns1="http://oracle.com/sca/soapservice/E008TransactionDetailPALStoPortalApp/E008TransactionDetailPALStoPortal/E008TransactionDetailPALStoPortalClient" xmlns:bpelx="http://schemas.oracle.com/bpel/extension" xmlns:ns2="http://xmlns.oracle.com/pcbpel/adapter/db/E008TransactionDetailPALStoPortalApp/E008TransactionDetailPALStoPortal/SelectDeltaTSDatabaseAdapterV1" xmlns:bpel2="http://docs.oasis-open.org/wsbpel/2.0/process/executable" xmlns:xp20="http://www.oracle.com/XSL/Transform/java/oracle.tip.pc.services.functions.Xpath20" xmlns:aia="http://www.oracle.com/XSL/Transform/java/oracle.apps.aia.core.xpath.AIAFunctions" xmlns:oraext="http://www.oracle.com/XSL/Transform/java/oracle.tip.pc.services.functions.ExtFunc" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:dvm="http://www.oracle.com/XSL/Transform/java/oracle.tip.dvm.LookupValue" xmlns:hwf="http://xmlns.oracle.com/bpel/workflow/xpath" xmlns:ns3="http://xmlns.oracle.com/pcbpel/adapter/db/top/SelectDeltaTSDatabaseAdapterV1" xmlns:ids="http://xmlns.oracle.com/bpel/services/IdentityService/xpath" xmlns:bpm="http://xmlns.oracle.com/bpmn20/extensions" xmlns:xdk="http://schemas.oracle.com/bpel/extension/xpath/function/xdk" xmlns:xref="http://www.oracle.com/XSL/Transform/java/oracle.tip.xref.xpath.XRefXPathFunctions" xmlns:ldap="http://schemas.oracle.com/xpath/extension/ldap" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:ns4="http://xmlns.oracle.com/pcbpel/adapter/db/E008TransactionDetailPALStoPortalApp/E008TransactionDetailPALStoPortal/SelectCountPALSDB2DatabaseAdapterV1" xmlns:ns5="http://xmlns.oracle.com/pcbpel/adapter/db/SelectCountPALSDB2DatabaseAdapterV1" xmlns:ns6="http://www.statoilfuelretail.com/integration/E008/E008InvocationReqMsg" xmlns:ns7="http://xmlns.oracle.com/pcbpel/adapter/db/E008TransactionDetailPALStoPortalApp/E008TransactionDetailPALStoPortal/SelectPALSDB2DatabaseAdapterV1" xmlns:ns8="http://xmlns.oracle.com/pcbpel/adapter/db/top/SelectPALSDB2DatabaseAdapterV1" xmlns:ns9="http://xmlns.oracle.com/pcbpel/adapter/db/E008TransactionDetailPALStoPortalApp/E008TransactionDetailPALStoPortal/MergeTransactionDetailErrorLogDatabaseAdapterV1" xmlns:ns10="http://xmlns.oracle.com/pcbpel/adapter/db/E008TransactionDetailPALStoPortalApp/E008TransactionDetailPALStoPortal/MergeSOADeltaTSDatabaseAdapterV1" xmlns:ns11="http://xmlns.oracle.com/pcbpel/adapter/db/E008TransactionDetailPALStoPortalApp/E008TransactionDetailPALStoPortal/MergeTransactionDetailPortalDatabaseAdapterV1" xmlns:ns12="http://xmlns.oracle.com/pcbpel/adapter/db/E008TransactionDetailPALStoPortalApp/E008TransactionDetailPALStoPortal/MergeTransactionDetailDatabaseAdapterV1" xmlns:ns13="http://www.statoilfuelretail.com/integration/E008/ValidatePALSDB2" xmlns:ns14="http://xmlns.oracle.com/pcbpel/adapter/db/top/MergeTransactionDetailErrorLogDatabaseAdapterV1" xmlns:ns15="http://xmlns.oracle.com/pcbpel/adapter/db/top/MergeSOADeltaTSDatabaseAdapterV1" xmlns:ns16="http://xmlns.oracle.com/pcbpel/adapter/db/E008TransactionDetailPALStoPortalApp/E008TransactionDetailPALStoPortal/MergeTransactionDetailsTempDatabaseAdapterV1" xmlns:ns17="http://xmlns.oracle.com/pcbpel/adapter/db/E008TransactionDetailPALStoPortalApp/E008TransactionDetailPALStoPortal/SelectErrorTransactionDetailTemp" xmlns:ns18="http://xmlns.oracle.com/pcbpel/adapter/db/E008TransactionDetailPALStoPortalApp/E008TransactionDetailPALStoPortal/SelectValidTransactionDetailtemp" xmlns:ns19="http://xmlns.oracle.com/pcbpel/adapter/db/E008TransactionDetailPALStoPortalApp/E008TransactionDetailPALStoPortal/DeleteTransactionDetailsTemp" xmlns:ns20="http://xmlns.oracle.com/pcbpel/adapter/db/E008TransactionDetailPALStoPortalApp/E008TransactionDetailPALStoPortal/SelectTransactionDetailErrorLogDatabsaeAdapterV1" xmlns:ns21="http://xmlns.oracle.com/pcbpel/adapter/jms/E008TransactionDetailPALStoPortalApp/E008TransactionDetailPALStoPortal/SOAErrorHandlerJMSQAdapter" xmlns:ns22="http://www.statoilfuelretail.com/integration/engage/ErrorHandling.xsd" xmlns:ns23="http://xmlns.oracle.com/pcbpel/adapter/db/top/MergeTransactionDetailDatabaseAdapterV1" xmlns:ns24="http://xmlns.oracle.com/pcbpel/adapter/db/E008TransactionDetailPALStoPortalApp/E008TransactionDetailPALStoPortal/UpdateTrxnDtlErrorLogDatabaseAdapterV1" xmlns:ns25="http://xmlns.oracle.com/pcbpel/adapter/db/SelectTransactionDetailErrorLogDatabsaeAdapterV1" id="BpPrc0">
  <!-- 
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
     ORCHESTRATION LOGIC                                               
     Set of activities coordinating the flow of messages across the    
     services integrated within this business process                  
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  -->
  <partnerLinks>
    <partnerLink name="E008TransactionDetailPALStoPortalClient" partnerLinkType="ns1:E008TransactionDetailPALStoPortalClient" myRole="execute_ptt"/>
    <partnerLink name="SelectDeltaTSDatabaseAdapterV1" partnerLinkType="ns2:SelectDeltaTSDatabaseAdapterV1_plt" partnerRole="SelectDeltaTSDatabaseAdapterV1_role"/>
    <partnerLink name="SelectCountPALSDB2DatabaseAdapterV1" partnerLinkType="ns4:SelectCountPALSDB2DatabaseAdapterV1_plt" partnerRole="SelectCountPALSDB2DatabaseAdapterV1_role"/>
    <partnerLink name="SelectPALSDB2DatabaseAdapterV1" partnerLinkType="ns7:SelectPALSDB2DatabaseAdapterV1_plt" partnerRole="SelectPALSDB2DatabaseAdapterV1_role"/>
    <partnerLink name="MergeTransactionDetailErrorLogDatabaseAdapterV1" partnerLinkType="ns9:MergeTransactionDetailErrorLogDatabaseAdapterV1_plt" partnerRole="MergeTransactionDetailErrorLogDatabaseAdapterV1_role"/>
    <partnerLink name="MergeSOADeltaTSDatabaseAdapterV1" partnerLinkType="ns10:MergeSOADeltaTSDatabaseAdapterV1_plt" partnerRole="MergeSOADeltaTSDatabaseAdapterV1_role"/>
    <partnerLink name="MergeTransactionDetailDatabaseAdapterV1" partnerLinkType="ns12:MergeTransactionDetailDatabaseAdapterV1_plt" partnerRole="MergeTransactionDetailDatabaseAdapterV1_role"/>
    <partnerLink name="MergeTransactionDetailsTempDatabaseAdapterV1" partnerLinkType="ns16:MergeTransactionDetailsTempDatabaseAdapterV1_plt" partnerRole="MergeTransactionDetailsTempDatabaseAdapterV1_role"/>
    <partnerLink name="SelectErrorTransactionDetailTemp" partnerLinkType="ns17:SelectErrorTransactionDetailTemp_plt" partnerRole="SelectErrorTransactionDetailTemp_role"/>
    <partnerLink name="SelectValidTransactionDetailtemp" partnerLinkType="ns18:SelectValidTransactionDetailtemp_plt" partnerRole="SelectValidTransactionDetailtemp_role"/>
    <partnerLink name="DeleteTransactionDetailsTemp" partnerLinkType="ns19:DeleteTransactionDetailsTemp_plt" partnerRole="DeleteTransactionDetailsTemp_role"/>
    <partnerLink name="SelectTransactionDetailErrorLogDatabsaeAdapterV1" partnerLinkType="ns20:SelectTransactionDetailErrorLogDatabsaeAdapterV1_plt" partnerRole="SelectTransactionDetailErrorLogDatabsaeAdapterV1_role"/>
    <partnerLink name="SOAErrorHandlerJMSQAdapter" partnerLinkType="ns21:Produce_Message_plt" partnerRole="Produce_Message_role"/>
    <partnerLink name="UpdateTrxnDtlErrorLogDatabaseAdapterV1" partnerLinkType="ns24:UpdateTrxnDtlErrorLogDatabaseAdapterV1_plt" partnerRole="UpdateTrxnDtlErrorLogDatabaseAdapterV1_role"/>
  </partnerLinks>
  <variables>
    <variable name="ReceiveInvocationMsgIV" messageType="ns1:requestMessage"/>
    <variable name="InvokeSelectDeltaTSDBAdapterV1_IV" messageType="ns2:SelectDeltaTSDatabaseAdapterV1Select_inputParameters"/>
    <variable name="InvokeSelectDeltaTSDBAdapterV1_OV" messageType="ns2:EngageSoaDeltatableCollection_msg"/>
    <variable name="DeltaTS" type="xsd:string"/>
    <variable name="InvokeSelectCountPALSDB2DBadapterV1_IV" messageType="ns4:SelectCountPALSDB2DatabaseAdapterV1Input_msg"/>
    <variable name="InvokeSelectCountPALSDB2DBadapterV1_OV" messageType="ns4:SelectCountPALSDB2DatabaseAdapterV1Output_msg"/>
    <variable name="BatchCount" type="xsd:integer"/>
    <variable name="PALSJNDI" type="xsd:string"/>
    <variable name="BatchSize" type="xsd:integer"/>
    <variable name="Invoke_SelectPALSDB2DatabaseAdapterV1_IV" messageType="ns7:SelectPALSDB2DatabaseAdapterV1Select_inputParameters"/>
    <variable name="Invoke_SelectPALSDB2DatabaseAdapterV1_OV" messageType="ns7:Cc078Vs1CssolnjDtaCollection_msg"/>
    <variable name="DataCount" type="xsd:integer"/>
    <variable name="TransactionDetailValidate" element="ns13:ValidationPayload"/>
    <variable name="InvokeMergeTrxnDtlErrorLogDBAdapter_IV" messageType="ns9:EngageSoaTxndtlErrorlogCollection_msg"/>
    <variable name="ErrorFlag" type="xsd:string"/>
    <variable name="InvokeMergeTransactionDetalDBAdapterV1_IV" messageType="ns12:PrtCardTransactionDetailCollection_msg"/>
    <variable name="InvokeMergeSOADeltaTSDBAdapterV1_IV" messageType="ns10:EngageSoaDeltatableCollection_msg"/>
    <variable name="InvokeMergeTransactionDetailTemp_IV" messageType="ns16:SoaTrxndtlTempCollection_msg"/>
    <variable name="InvokeSelectErrorTransactionDetailTemp_IV" messageType="ns17:SelectErrorTransactionDetailTempInput_msg"/>
    <variable name="InvokeSelectErrorTransactionDetailTemp_OV" messageType="ns17:SelectErrorTransactionDetailTempOutputCollection_msg"/>
    <variable name="InvokeSelectValidTransactionDetailTemp_IV" messageType="ns18:SelectValidTransactionDetailtempInput_msg"/>
    <variable name="InvokeSelectValidTransactionDetailTemp_OV" messageType="ns18:SelectValidTransactionDetailtempOutputCollection_msg"/>
    <variable name="InvokeMergeTransactionDetail_IV" messageType="ns12:PrtCardTransactionDetailCollection_msg"/>
    <variable name="InvokeDeleteTransactionDetailtemp_IV" messageType="ns19:DeleteTransactionDetailsTempInput_msg"/>
    <variable name="InvokeSelectTransactionDetailErrorLogDBAdapter_IV" messageType="ns20:SelectTransactionDetailErrorLogDatabsaeAdapterV1Input_msg"/>
    <variable name="InvokeSelectTransactionDetailErrorLogDBAdapter_OV" messageType="ns20:SelectTransactionDetailErrorLogDatabsaeAdapterV1OutputCollection_msg"/>
    <variable name="InvokeSOAErrorHandlerJMSQAdapter_IV" messageType="ns21:Produce_Message_msg"/>
    <variable name="InvokeUpdateTrxnDtlErrorLogDBAdapterV1_IV" messageType="ns24:EngageSoaTxndtlErrorlogCollection_msg"/>
  </variables>
  <faultHandlers id="BpFhs0">
    <catch faultName="bpelx:remoteFault" id="BpCFt0">
      <sequence name="RemotefaultSequence" id="BpSeq0">
        <assign name="AssignRemoteFault" id="BpAss0">
          <copy>
            <from expression="ora:getCompositeInstanceId()"/>
            <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:CommonErrorData/ns22:InstanceID"/>
          </copy>
          <copy>
            <from expression="'Error Interface ID E008'"/>
            <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:ErrorNotification/ns22:Subject"/>
          </copy>
          <copy>
            <from expression="'E008_TE'"/>
            <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:ErrorNotification/ns22:LookupCriteria"/>
          </copy>
          <copy>
            <from expression="ora:getComponentName()"/>
            <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:CommonErrorData/ns22:ComponentName"/>
          </copy>
          <copy>
            <from expression="'E008'"/>
            <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:CommonErrorData/ns22:ProjectID"/>
          </copy>
          <copy>
            <from expression="'E008TransactionDetailPALStoPortal'"/>
            <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:CommonErrorData/ns22:ProjectName"/>
          </copy>
          <copy>
            <from expression="xp20:current-dateTime()"/>
            <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:CommonErrorData/ns22:Timestamp"/>
          </copy>
          <copy>
            <from variable="ReceiveInvocationMsgIV" part="invocationPayload" query="/ns6:invocationMsg/ns6:SenderSystem"/>
            <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:CommonErrorData/ns22:Source"/>
          </copy>
          <copy>
            <from variable="ReceiveInvocationMsgIV" part="invocationPayload" query="/ns6:invocationMsg/ns6:ReceiverSystem"/>
            <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:CommonErrorData/ns22:Target"/>
          </copy>
          <copy>
            <from variable="ReceiveInvocationMsgIV" part="invocationPayload" query="/ns6:invocationMsg/ns6:UserName"/>
            <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:CommonErrorData/ns22:UserID"/>
          </copy>
          <copy>
            <from expression="'TE-002'"/>
            <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:ErrorDetails/ns22:ErrorCode"/>
          </copy>
          <copy>
            <from expression="ora:getFaultAsString()"/>
            <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:ErrorDetails/ns22:ErrorDescription"/>
          </copy>
          <copy>
            <from expression="'Remote Error in E008'"/>
            <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:ErrorDetails/ns22:ErrorSummary"/>
          </copy>
        </assign>
        <invoke name="InvokeSOARemoteErrorHandlerJMSAdapter" inputVariable="InvokeSOAErrorHandlerJMSQAdapter_IV" partnerLink="SOAErrorHandlerJMSQAdapter" portType="ns21:Produce_Message_ptt" operation="Produce_Message" bpelx:invokeAsDetail="no" id="BpInv0"/>
      </sequence>
    </catch>
    <catch faultName="bpelx:bindingFault" id="BpCFt1">
      <sequence name="BindingFaultSequence" id="BpSeq1">
        <assign name="AssignBindingFault" id="BpAss1">
          <copy>
            <from expression="ora:getCompositeInstanceId()"/>
            <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:CommonErrorData/ns22:InstanceID"/>
          </copy>
          <copy>
            <from expression="ora:getComponentName()"/>
            <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:CommonErrorData/ns22:ComponentName"/>
          </copy>
          <copy>
            <from expression="'E008'"/>
            <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:CommonErrorData/ns22:ProjectID"/>
          </copy>
          <copy>
            <from expression="'E008TransactionDetailPALStoPortal'"/>
            <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:CommonErrorData/ns22:ProjectName"/>
          </copy>
          <copy>
            <from expression="xp20:current-dateTime()"/>
            <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:CommonErrorData/ns22:Timestamp"/>
          </copy>
          <copy>
            <from variable="ReceiveInvocationMsgIV" part="invocationPayload" query="/ns6:invocationMsg/ns6:SenderSystem"/>
            <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:CommonErrorData/ns22:Source"/>
          </copy>
          <copy>
            <from variable="ReceiveInvocationMsgIV" part="invocationPayload" query="/ns6:invocationMsg/ns6:ReceiverSystem"/>
            <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:CommonErrorData/ns22:Target"/>
          </copy>
          <copy>
            <from variable="ReceiveInvocationMsgIV" part="invocationPayload" query="/ns6:invocationMsg/ns6:UserName"/>
            <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:CommonErrorData/ns22:UserID"/>
          </copy>
          <copy>
            <from expression="'TE-001'"/>
            <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:ErrorDetails/ns22:ErrorCode"/>
          </copy>
          <copy>
            <from expression="ora:getFaultAsString()"/>
            <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:ErrorDetails/ns22:ErrorDescription"/>
          </copy>
          <copy>
            <from expression="'E008_TE'"/>
            <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:ErrorNotification/ns22:LookupCriteria"/>
          </copy>
          <copy>
            <from expression="'Error in Interface ID E008'"/>
            <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:ErrorNotification/ns22:Subject"/>
          </copy>
          <copy>
            <from expression="'Binding Fault in E008'"/>
            <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:ErrorDetails/ns22:ErrorSummary"/>
          </copy>
        </assign>
        <invoke name="InvokeSOABindingErrorHandlerJMSAdapter" inputVariable="InvokeSOAErrorHandlerJMSQAdapter_IV" partnerLink="SOAErrorHandlerJMSQAdapter" portType="ns21:Produce_Message_ptt" operation="Produce_Message" bpelx:invokeAsDetail="no" id="BpInv1"/>
      </sequence>
    </catch>
    <catchAll id="BpCAl0">
      <sequence name="OtherTechnicalFaultSequence" id="BpSeq2">
        <assign name="AssignTecnicalFault" id="BpAss2">
          <copy>
            <from expression="ora:getCompositeInstanceId()"/>
            <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:CommonErrorData/ns22:InstanceID"/>
          </copy>
          <copy>
            <from expression="'Error Interface ID E008'"/>
            <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:ErrorNotification/ns22:Subject"/>
          </copy>
          <copy>
            <from expression="'E008_TE'"/>
            <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:ErrorNotification/ns22:LookupCriteria"/>
          </copy>
          <copy>
            <from expression="ora:getComponentName()"/>
            <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:CommonErrorData/ns22:ComponentName"/>
          </copy>
          <copy>
            <from expression="'E008'"/>
            <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:CommonErrorData/ns22:ProjectID"/>
          </copy>
          <copy>
            <from expression="'E008TransactionDetailPALStoPortal'"/>
            <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:CommonErrorData/ns22:ProjectName"/>
          </copy>
          <copy>
            <from expression="xp20:current-dateTime()"/>
            <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:CommonErrorData/ns22:Timestamp"/>
          </copy>
          <copy>
            <from variable="ReceiveInvocationMsgIV" part="invocationPayload" query="/ns6:invocationMsg/ns6:SenderSystem"/>
            <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:CommonErrorData/ns22:Source"/>
          </copy>
          <copy>
            <from variable="ReceiveInvocationMsgIV" part="invocationPayload" query="/ns6:invocationMsg/ns6:ReceiverSystem"/>
            <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:CommonErrorData/ns22:Target"/>
          </copy>
          <copy>
            <from variable="ReceiveInvocationMsgIV" part="invocationPayload" query="/ns6:invocationMsg/ns6:UserName"/>
            <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:CommonErrorData/ns22:UserID"/>
          </copy>
          <copy>
            <from expression="'TE-003'"/>
            <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:ErrorDetails/ns22:ErrorCode"/>
          </copy>
          <copy>
            <from expression="ora:getFaultAsString()"/>
            <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:ErrorDetails/ns22:ErrorDescription"/>
          </copy>
          <copy>
            <from expression="'Technical Fault in E008'"/>
            <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:ErrorDetails/ns22:ErrorSummary"/>
          </copy>
        </assign>
        <invoke name="InvokeSOATechnicalErrorHandlerJMSAdapter" inputVariable="InvokeSOAErrorHandlerJMSQAdapter_IV" partnerLink="SOAErrorHandlerJMSQAdapter" portType="ns21:Produce_Message_ptt" operation="Produce_Message" bpelx:invokeAsDetail="no" id="BpInv2"/>
      </sequence>
    </catchAll>
  </faultHandlers>
  <sequence name="main" id="BpSeq3">
    <receive name="ReceiveInvocationMsg" createInstance="yes" variable="ReceiveInvocationMsgIV" partnerLink="E008TransactionDetailPALStoPortalClient" portType="ns1:execute_ptt" operation="execute" id="BpRcv0"/>
    <assign name="AssignInitialValues" id="BpAss3">
      <copy>
        <from variable="ReceiveInvocationMsgIV" part="invocationPayload" query="/ns6:invocationMsg/ns6:DatabaseJNDI"/>
        <to variable="PALSJNDI"/>
      </copy>
      <copy>
        <from expression="'NO'"/>
        <to variable="ErrorFlag"/>
      </copy>
      <copy>
        <from variable="ReceiveInvocationMsgIV" part="invocationPayload" query="/ns6:invocationMsg/ns6:BatchSize"/>
        <to variable="BatchSize"/>
      </copy>
    </assign>
    <scope name="GetDeltaTSScope" variableAccessSerializable="no" id="BpScp0">
      <sequence name="GetDeltaTSSequence" id="BpSeq4">
        <assign name="AssignDeltaTSInputValues" id="BpAss4">
          <copy>
            <from variable="ReceiveInvocationMsgIV" part="invocationPayload" query="/ns6:invocationMsg/ns6:InterfaceID"/>
            <to variable="InvokeSelectDeltaTSDBAdapterV1_IV" part="SelectDeltaTSDatabaseAdapterV1Select_inputParameters" query="/ns3:SelectDeltaTSDatabaseAdapterV1Select_interfaceID_countryCodeInputParameters/ns3:interfaceID"/>
          </copy>
          <copy>
            <from variable="ReceiveInvocationMsgIV" part="invocationPayload" query="/ns6:invocationMsg/ns6:CountryCode"/>
            <to variable="InvokeSelectDeltaTSDBAdapterV1_IV" part="SelectDeltaTSDatabaseAdapterV1Select_inputParameters" query="/ns3:SelectDeltaTSDatabaseAdapterV1Select_interfaceID_countryCodeInputParameters/ns3:countryCode"/>
          </copy>
        </assign>
        <invoke name="InvokeSelectDeltaTSDBAdapterV1" inputVariable="InvokeSelectDeltaTSDBAdapterV1_IV" outputVariable="InvokeSelectDeltaTSDBAdapterV1_OV" partnerLink="SelectDeltaTSDatabaseAdapterV1" portType="ns2:SelectDeltaTSDatabaseAdapterV1_ptt" operation="SelectDeltaTSDatabaseAdapterV1Select" bpelx:invokeAsDetail="no" id="BpInv3"/>
      </sequence>
    </scope>
    <switch name="Switch1" id="BpSwt0">
      <case condition="count(bpws:getVariableData('InvokeSelectDeltaTSDBAdapterV1_OV','EngageSoaDeltatableCollection','/ns3:EngageSoaDeltatableCollection/ns3:EngageSoaDeltatable'))>0">
        <bpelx:annotation>
          <bpelx:general>
            <bpelx:property name="userLabel">IF DeltaTS exists</bpelx:property>
          </bpelx:general>
        </bpelx:annotation>
        <sequence name="Convert_DeltaTS_Sequence" id="BpSeq5">
          <assign name="AssignDeltaTS" id="BpAss5">
            <copy>
              <from variable="InvokeSelectDeltaTSDBAdapterV1_OV" part="EngageSoaDeltatableCollection" query="/ns3:EngageSoaDeltatableCollection/ns3:EngageSoaDeltatable/ns3:palsDeltaTimestamp"/>
              <to variable="DeltaTS"/>
            </copy>
          </assign>
          <assign name="ConvertDateTime" id="BpAss6">
            <copy>
              <from expression="substring-before(bpws:getVariableData('DeltaTS'),'+')"/>
              <to variable="DeltaTS"/>
            </copy>
            <copy>
              <from expression="concat(substring-before(bpws:getVariableData('DeltaTS'),'T'),' ',substring-after(bpws:getVariableData('DeltaTS'),'T'))"/>
              <to variable="DeltaTS"/>
            </copy>
          </assign>
        </sequence>
      </case>
      <otherwise>
        <assign name="AssignDefaultDeltaTS" id="BpAss7">
          <copy>
            <from expression="'0001-01-01 00:00:00.000000'"/>
            <to variable="DeltaTS"/>
          </copy>
        </assign>
      </otherwise>
    </switch>
    <scope name="GetCountFromPALSScope" variableAccessSerializable="no" id="BpScp1">
      <sequence name="GetCountfromPALSSequence" id="BpSeq6">
        <assign name="AssignDeltaTSValue" id="BpAss8">
          <copy>
            <from variable="DeltaTS"/>
            <to variable="InvokeSelectCountPALSDB2DBadapterV1_IV" part="SelectCountPALSDB2DatabaseAdapterV1Input_msg" query="/ns5:SelectCountPALSDB2DatabaseAdapterV1Input/ns5:deltats"/>
          </copy>
        </assign>
        <invoke name="InvokeSelectCountPALSDB2DBadapterV1" inputVariable="InvokeSelectCountPALSDB2DBadapterV1_IV" outputVariable="InvokeSelectCountPALSDB2DBadapterV1_OV" partnerLink="SelectCountPALSDB2DatabaseAdapterV1" portType="ns4:SelectCountPALSDB2DatabaseAdapterV1_ptt" operation="SelectCountPALSDB2DatabaseAdapterV1" bpelx:invokeAsDetail="no" id="BpInv4">
          <bpelx:inputProperty name="jca.jndi" variable="PALSJNDI"/>
        </invoke>
        <switch name="Switch5" id="BpSwt1">
          <case condition="(bpws:getVariableData('ReceiveInvocationMsgIV','invocationPayload','/ns6:invocationMsg/ns6:BatchCount')!='') and (number(bpws:getVariableData('ReceiveInvocationMsgIV','invocationPayload','/ns6:invocationMsg/ns6:BatchCount'))&lt;ceiling(bpws:getVariableData('InvokeSelectCountPALSDB2DBadapterV1_OV','SelectCountPALSDB2DatabaseAdapterV1Output','/ns5:SelectCountPALSDB2DatabaseAdapterV1Output/ns5:_1') div bpws:getVariableData('BatchSize')))">
            <bpelx:annotation>
              <bpelx:general>
                <bpelx:property name="userLabel">If batch count is sent</bpelx:property>
              </bpelx:general>
            </bpelx:annotation>
            <assign name="AssignBatchCount" id="BpAss9">
              <copy>
                <from variable="ReceiveInvocationMsgIV" part="invocationPayload" query="/ns6:invocationMsg/ns6:BatchCount"/>
                <to variable="BatchCount"/>
              </copy>
            </assign>
          </case>
          <otherwise>
            <assign name="CalculateBatchCount" id="BpAss10">
              <copy>
                <from expression="ceiling(bpws:getVariableData('InvokeSelectCountPALSDB2DBadapterV1_OV','SelectCountPALSDB2DatabaseAdapterV1Output','/ns5:SelectCountPALSDB2DatabaseAdapterV1Output/ns5:_1') div bpws:getVariableData('BatchSize'))"/>
                <to variable="BatchCount"/>
              </copy>
            </assign>
          </otherwise>
        </switch>
      </sequence>
    </scope>
    <while name="WhileEachBatch" condition="bpws:getVariableData('BatchCount')>0" id="BpWhl0">
      <sequence name="GetPALSDATASequence" id="BpSeq7">
        <assign name="AssignLatestDeltaTS" id="BpAss11">
          <copy>
            <from variable="ReceiveInvocationMsgIV" part="invocationPayload" query="/ns6:invocationMsg/ns6:InterfaceID"/>
            <to variable="InvokeSelectDeltaTSDBAdapterV1_IV" part="SelectDeltaTSDatabaseAdapterV1Select_inputParameters" query="/ns3:SelectDeltaTSDatabaseAdapterV1Select_interfaceID_countryCodeInputParameters/ns3:interfaceID"/>
          </copy>
          <copy>
            <from variable="ReceiveInvocationMsgIV" part="invocationPayload" query="/ns6:invocationMsg/ns6:CountryCode"/>
            <to variable="InvokeSelectDeltaTSDBAdapterV1_IV" part="SelectDeltaTSDatabaseAdapterV1Select_inputParameters" query="/ns3:SelectDeltaTSDatabaseAdapterV1Select_interfaceID_countryCodeInputParameters/ns3:countryCode"/>
          </copy>
        </assign>
        <invoke name="InvokeSOADeltaTs" inputVariable="InvokeSelectDeltaTSDBAdapterV1_IV" outputVariable="InvokeSelectDeltaTSDBAdapterV1_OV" partnerLink="SelectDeltaTSDatabaseAdapterV1" portType="ns2:SelectDeltaTSDatabaseAdapterV1_ptt" operation="SelectDeltaTSDatabaseAdapterV1Select" bpelx:invokeAsDetail="no" id="BpInv5"/>
        <switch name="Switch2" id="BpSwt2">
          <case condition="count(bpws:getVariableData('InvokeSelectDeltaTSDBAdapterV1_OV','EngageSoaDeltatableCollection','/ns3:EngageSoaDeltatableCollection/ns3:EngageSoaDeltatable'))>0">
            <bpelx:annotation>
              <bpelx:general>
                <bpelx:property name="userLabel">IF DELTA_TS exists</bpelx:property>
              </bpelx:general>
            </bpelx:annotation>
            <sequence name="ConvertDeltaTSSequence" id="BpSeq8">
              <assign name="AssignDeltaTS" id="BpAss12">
                <copy>
                  <from variable="InvokeSelectDeltaTSDBAdapterV1_OV" part="EngageSoaDeltatableCollection" query="/ns3:EngageSoaDeltatableCollection/ns3:EngageSoaDeltatable/ns3:palsDeltaTimestamp"/>
                  <to variable="DeltaTS"/>
                </copy>
              </assign>
              <assign name="ConvertDeltaTS" id="BpAss13">
                <copy>
                  <from expression="substring-before(bpws:getVariableData('DeltaTS'),'+')"/>
                  <to variable="DeltaTS"/>
                </copy>
                <copy>
                  <from expression="concat(substring-before(bpws:getVariableData('DeltaTS'),'T'),' ',substring-after(bpws:getVariableData('DeltaTS'),'T'))"/>
                  <to variable="DeltaTS"/>
                </copy>
              </assign>
            </sequence>
          </case>
          <otherwise>
            <assign name="AssignDefaultDeltaTS" id="BpAss14">
              <copy>
                <from expression="'0001-01-01 00:00:00.000000'"/>
                <to variable="DeltaTS"/>
              </copy>
            </assign>
          </otherwise>
        </switch>
        <assign name="AssignInvokeSelectPALSDB2DBIV" id="BpAss15">
          <copy>
            <from variable="DeltaTS"/>
            <to variable="Invoke_SelectPALSDB2DatabaseAdapterV1_IV" part="SelectPALSDB2DatabaseAdapterV1Select_inputParameters" query="/ns8:SelectPALSDB2DatabaseAdapterV1Select_DELTA_TS_BatchSizeInputParameters/ns8:DELTA_TS"/>
          </copy>
          <copy>
            <from variable="BatchSize"/>
            <to variable="Invoke_SelectPALSDB2DatabaseAdapterV1_IV" part="SelectPALSDB2DatabaseAdapterV1Select_inputParameters" query="/ns8:SelectPALSDB2DatabaseAdapterV1Select_DELTA_TS_BatchSizeInputParameters/ns8:BatchSize"/>
          </copy>
        </assign>
        <invoke name="InvokeSelectPALSDB2DBAdapterV1" inputVariable="Invoke_SelectPALSDB2DatabaseAdapterV1_IV" outputVariable="Invoke_SelectPALSDB2DatabaseAdapterV1_OV" partnerLink="SelectPALSDB2DatabaseAdapterV1" portType="ns7:SelectPALSDB2DatabaseAdapterV1_ptt" operation="SelectPALSDB2DatabaseAdapterV1Select" bpelx:invokeAsDetail="no" id="BpInv6">
          <bpelx:inputProperty name="jca.jndi" variable="PALSJNDI"/>
        </invoke>
        <assign name="GetDataCount" id="BpAss16">
          <copy>
            <from expression="count(bpws:getVariableData('Invoke_SelectPALSDB2DatabaseAdapterV1_OV','Cc078Vs1CssolnjDtaCollection','/ns8:Cc078Vs1CssolnjDtaCollection/ns8:Cc078Vs1CssolnjDta'))"/>
            <to variable="DataCount"/>
          </copy>
        </assign>
        <scope name="ValidateselectDB2Scope" variableAccessSerializable="no" id="BpScp2">
          <faultHandlers id="BpFhs1">
            <catch faultName="bpelx:invalidVariables" id="BpCFt2">
              <sequence name="ValidatePALSDB2ErrorSequence" id="BpSeq9">
                <assign name="xformPALSDB2tiErrorLog" id="BpAss17">
                  <bpelx:annotation>
                    <bpelx:pattern>transformation</bpelx:pattern>
                  </bpelx:annotation>
                  <copy>
                    <from expression="ora:doXSLTransformForDoc('xsl/SelectPALSDB2_to_TrxnDtlErrorLog.xsl', $Invoke_SelectPALSDB2DatabaseAdapterV1_OV.Cc078Vs1CssolnjDtaCollection, 'ReceiveInvocationMsgIV.invocationPayload', $ReceiveInvocationMsgIV.invocationPayload)"/>
                    <to variable="InvokeMergeTrxnDtlErrorLogDBAdapter_IV" part="EngageSoaTxndtlErrorlogCollection"/>
                  </copy>
                </assign>
                <invoke name="InvokeMergeTrxnDtlErrorLogDBAdapter" inputVariable="InvokeMergeTrxnDtlErrorLogDBAdapter_IV" partnerLink="MergeTransactionDetailErrorLogDatabaseAdapterV1" portType="ns9:MergeTransactionDetailErrorLogDatabaseAdapterV1_ptt" operation="merge" bpelx:invokeAsDetail="no" id="BpInv7"/>
                <assign name="AssignErrorFlag" id="BpAss18">
                  <copy>
                    <from expression="'YES'"/>
                    <to variable="ErrorFlag"/>
                  </copy>
                </assign>
              </sequence>
            </catch>
          </faultHandlers>
          <sequence name="ValidatePALSDB2Sequence" id="BpSeq10">
            <assign name="xformPALSDB2toPortalValidate" id="BpAss19">
              <bpelx:annotation>
                <bpelx:pattern>transformation</bpelx:pattern>
              </bpelx:annotation>
              <copy>
                <from expression="ora:doXSLTransformForDoc('xsl/SelectPALSDB2_to_TransactionDetailValidate.xsl', $Invoke_SelectPALSDB2DatabaseAdapterV1_OV.Cc078Vs1CssolnjDtaCollection)"/>
                <to variable="TransactionDetailValidate"/>
              </copy>
            </assign>
            <bpelx:validate name="ValidateTransactionDetail" variables="TransactionDetailValidate" id="BpVal0"/>
          </sequence>
        </scope>
        <scope name="MergetransactionDetailScope" variableAccessSerializable="no" id="BpScp3">
          <faultHandlers id="BpFhs2">
            <catch faultName="bpelx:bindingFault" id="BpCFt3">
              <switch name="Switch3" id="BpSwt3">
                <case condition="contains(ora:getFaultAsString(),'integrity constraint')">
                  <bpelx:annotation>
                    <bpelx:general>
                      <bpelx:property name="userLabel">IF foreign Key Constraint is violated</bpelx:property>
                    </bpelx:general>
                  </bpelx:annotation>
                  <sequence name="MergetransactionDetailErrorSequence" id="BpSeq11">
                    <assign name="formPALSDB2toTransactionDetailTemp" id="BpAss20">
                      <bpelx:annotation>
                        <bpelx:pattern>transformation</bpelx:pattern>
                      </bpelx:annotation>
                      <copy>
                        <from expression="ora:doXSLTransformForDoc('xsl/PALSDB2_to_TransactionDetailTemp.xsl', $ReceiveInvocationMsgIV.invocationPayload, 'Invoke_SelectPALSDB2DatabaseAdapterV1_OV.Cc078Vs1CssolnjDtaCollection', $Invoke_SelectPALSDB2DatabaseAdapterV1_OV.Cc078Vs1CssolnjDtaCollection)"/>
                        <to variable="InvokeMergeTransactionDetailTemp_IV" part="SoaTrxndtlTempCollection"/>
                      </copy>
                    </assign>
                    <invoke name="InvokeMergeTransactionDetailTemp" inputVariable="InvokeMergeTransactionDetailTemp_IV" partnerLink="MergeTransactionDetailsTempDatabaseAdapterV1" portType="ns16:MergeTransactionDetailsTempDatabaseAdapterV1_ptt" operation="merge" bpelx:invokeAsDetail="no" id="BpInv8"/>
                    <invoke name="InvokeSelectErrorTransactionDetailTemp" inputVariable="InvokeSelectErrorTransactionDetailTemp_IV" outputVariable="InvokeSelectErrorTransactionDetailTemp_OV" partnerLink="SelectErrorTransactionDetailTemp" portType="ns17:SelectErrorTransactionDetailTemp_ptt" operation="SelectErrorTransactionDetailTemp" bpelx:invokeAsDetail="no" id="BpInv9"/>
                    <assign name="xformTransactionDetailTemptoTransactioErrorLog" id="BpAss21">
                      <bpelx:annotation>
                        <bpelx:pattern>transformation</bpelx:pattern>
                      </bpelx:annotation>
                      <copy>
                        <from expression="ora:doXSLTransformForDoc('xsl/ErrorTrxnDetail_to_TrxnDtlErrorLog.xsl', $InvokeSelectErrorTransactionDetailTemp_OV.SelectErrorTransactionDetailTempOutputCollection)"/>
                        <to variable="InvokeMergeTrxnDtlErrorLogDBAdapter_IV" part="EngageSoaTxndtlErrorlogCollection"/>
                      </copy>
                    </assign>
                    <invoke name="InvokeMergeTransactionDetailErrorLog" inputVariable="InvokeMergeTrxnDtlErrorLogDBAdapter_IV" partnerLink="MergeTransactionDetailErrorLogDatabaseAdapterV1" portType="ns9:MergeTransactionDetailErrorLogDatabaseAdapterV1_ptt" operation="merge" bpelx:invokeAsDetail="no" id="BpInv10"/>
                    <invoke name="InvokeSelectValidTransactionDetailTemp" inputVariable="InvokeSelectValidTransactionDetailTemp_IV" outputVariable="InvokeSelectValidTransactionDetailTemp_OV" partnerLink="SelectValidTransactionDetailtemp" portType="ns18:SelectValidTransactionDetailtemp_ptt" operation="SelectValidTransactionDetailtemp" bpelx:invokeAsDetail="no" id="BpInv11"/>
                    <assign name="xformVaidTransactionDetailtoMergeTransactionDetail" id="BpAss22">
                      <bpelx:annotation>
                        <bpelx:pattern>transformation</bpelx:pattern>
                      </bpelx:annotation>
                      <copy>
                        <from expression="ora:doXSLTransformForDoc('xsl/ValidTransactionDetail_to_MergeTransactionDetail.xsl', $InvokeSelectValidTransactionDetailTemp_OV.SelectValidTransactionDetailtempOutputCollection)"/>
                        <to variable="InvokeMergeTransactionDetail_IV" part="PrtCardTransactionDetailCollection"/>
                      </copy>
                    </assign>
                    <invoke name="InvokeMergeTransactionDetail" inputVariable="InvokeMergeTransactionDetail_IV" partnerLink="MergeTransactionDetailDatabaseAdapterV1" portType="ns12:MergeTransactionDetailDatabaseAdapterV1_ptt" operation="merge" bpelx:invokeAsDetail="no" id="BpInv12"/>
                    <invoke name="InvokeDeleteTransactionDetailtemp" inputVariable="InvokeDeleteTransactionDetailtemp_IV" partnerLink="DeleteTransactionDetailsTemp" portType="ns19:DeleteTransactionDetailsTemp_ptt" operation="DeleteTransactionDetailsTemp" bpelx:invokeAsDetail="no" id="BpInv13"/>
                    <assign name="AssignErrorFlag" id="BpAss23">
                      <copy>
                        <from expression="'YES'"/>
                        <to variable="ErrorFlag"/>
                      </copy>
                    </assign>
                  </sequence>
                </case>
                <otherwise>
                  <sequence name="MergetransactionDetailBindingSequence" id="BpSeq12">
                    <assign name="AssignBindingFault" id="BpAss24">
                      <copy>
                        <from expression="ora:getCompositeInstanceId()"/>
                        <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:CommonErrorData/ns22:InstanceID"/>
                      </copy>
                      <copy>
                        <from expression="ora:getComponentName()"/>
                        <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:CommonErrorData/ns22:ComponentName"/>
                      </copy>
                      <copy>
                        <from expression="'E008'"/>
                        <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:CommonErrorData/ns22:ProjectID"/>
                      </copy>
                      <copy>
                        <from expression="'E008TransactionDetailPALStoPortal'"/>
                        <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:CommonErrorData/ns22:ProjectName"/>
                      </copy>
                      <copy>
                        <from expression="xp20:current-dateTime()"/>
                        <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:CommonErrorData/ns22:Timestamp"/>
                      </copy>
                      <copy>
                        <from variable="ReceiveInvocationMsgIV" part="invocationPayload" query="/ns6:invocationMsg/ns6:SenderSystem"/>
                        <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:CommonErrorData/ns22:Source"/>
                      </copy>
                      <copy>
                        <from variable="ReceiveInvocationMsgIV" part="invocationPayload" query="/ns6:invocationMsg/ns6:ReceiverSystem"/>
                        <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:CommonErrorData/ns22:Target"/>
                      </copy>
                      <copy>
                        <from variable="ReceiveInvocationMsgIV" part="invocationPayload" query="/ns6:invocationMsg/ns6:UserName"/>
                        <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:CommonErrorData/ns22:UserID"/>
                      </copy>
                      <copy>
                        <from expression="'TE-001'"/>
                        <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:ErrorDetails/ns22:ErrorCode"/>
                      </copy>
                      <copy>
                        <from expression="ora:getFaultAsString()"/>
                        <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:ErrorDetails/ns22:ErrorDescription"/>
                      </copy>
                      <copy>
                        <from expression="'E008_TE'"/>
                        <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:ErrorNotification/ns22:LookupCriteria"/>
                      </copy>
                      <copy>
                        <from expression="'Error in Interface ID E008'"/>
                        <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:ErrorNotification/ns22:Subject"/>
                      </copy>
                      <copy>
                        <from expression="'Binding Fault in E008'"/>
                        <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:ErrorDetails/ns22:ErrorSummary"/>
                      </copy>
                    </assign>
                    <invoke name="InvokeSOAErrorJMSQAdapter" inputVariable="InvokeSOAErrorHandlerJMSQAdapter_IV" partnerLink="SOAErrorHandlerJMSQAdapter" portType="ns21:Produce_Message_ptt" operation="Produce_Message" bpelx:invokeAsDetail="no" id="BpInv14"/>
                    <terminate name="TerminateFlow" id="BpTer0"/>
                  </sequence>
                </otherwise>
              </switch>
            </catch>
          </faultHandlers>
          <sequence name="MergetransactionDetailSequence" id="BpSeq13">
            <assign name="xformPALSDB2toTransactionDetailPortal" id="BpAss25">
              <bpelx:annotation>
                <bpelx:pattern>transformation</bpelx:pattern>
              </bpelx:annotation>
              <copy>
                <from expression="ora:doXSLTransformForDoc('xsl/PALSDB2_to_MergeTrxnDetailPortal.xsl', $ReceiveInvocationMsgIV.invocationPayload, 'Invoke_SelectPALSDB2DatabaseAdapterV1_OV.Cc078Vs1CssolnjDtaCollection', $Invoke_SelectPALSDB2DatabaseAdapterV1_OV.Cc078Vs1CssolnjDtaCollection)"/>
                <to variable="InvokeMergeTransactionDetalDBAdapterV1_IV" part="PrtCardTransactionDetailCollection"/>
              </copy>
            </assign>
            <invoke name="InvokeMergeTransactionDetalDBAdapterV1" inputVariable="InvokeMergeTransactionDetalDBAdapterV1_IV" partnerLink="MergeTransactionDetailDatabaseAdapterV1" portType="ns12:MergeTransactionDetailDatabaseAdapterV1_ptt" operation="merge" bpelx:invokeAsDetail="no" id="BpInv15"/>
          </sequence>
        </scope>
        <assign name="AssignMergeSOADeltaTSDBAdapterV1" id="BpAss26">
          <copy>
            <from variable="ReceiveInvocationMsgIV" part="invocationPayload" query="/ns6:invocationMsg/ns6:InterfaceID"/>
            <to variable="InvokeMergeSOADeltaTSDBAdapterV1_IV" part="EngageSoaDeltatableCollection" query="/ns15:EngageSoaDeltatableCollection/ns15:EngageSoaDeltatable/ns15:interfaceid"/>
          </copy>
          <copy>
            <from expression="bpws:getVariableData('Invoke_SelectPALSDB2DatabaseAdapterV1_OV','Cc078Vs1CssolnjDtaCollection','/ns8:Cc078Vs1CssolnjDtaCollection/ns8:Cc078Vs1CssolnjDta[$DataCount]/ns8:deltaTs')"/>
            <to variable="InvokeMergeSOADeltaTSDBAdapterV1_IV" part="EngageSoaDeltatableCollection" query="/ns15:EngageSoaDeltatableCollection/ns15:EngageSoaDeltatable/ns15:palsDeltaTimestamp"/>
          </copy>
          <copy>
            <from variable="ReceiveInvocationMsgIV" part="invocationPayload" query="/ns6:invocationMsg/ns6:UserName"/>
            <to variable="InvokeMergeSOADeltaTSDBAdapterV1_IV" part="EngageSoaDeltatableCollection" query="/ns15:EngageSoaDeltatableCollection/ns15:EngageSoaDeltatable/ns15:updatedby"/>
          </copy>
          <copy>
            <from expression="xp20:current-dateTime()"/>
            <to variable="InvokeMergeSOADeltaTSDBAdapterV1_IV" part="EngageSoaDeltatableCollection" query="/ns15:EngageSoaDeltatableCollection/ns15:EngageSoaDeltatable/ns15:modifiedbytimestamp"/>
          </copy>
          <copy>
            <from variable="ReceiveInvocationMsgIV" part="invocationPayload" query="/ns6:invocationMsg/ns6:CountryCode"/>
            <to variable="InvokeMergeSOADeltaTSDBAdapterV1_IV" part="EngageSoaDeltatableCollection" query="/ns15:EngageSoaDeltatableCollection/ns15:EngageSoaDeltatable/ns15:countrycode"/>
          </copy>
        </assign>
        <invoke name="InvokeMergeSOADeltaTSDBAdapterV1" inputVariable="InvokeMergeSOADeltaTSDBAdapterV1_IV" partnerLink="MergeSOADeltaTSDatabaseAdapterV1" portType="ns10:MergeSOADeltaTSDatabaseAdapterV1_ptt" operation="merge" bpelx:invokeAsDetail="no" id="BpInv16"/>
        <assign name="DecrementBatchCount" id="BpAss27">
          <copy>
            <from expression="bpws:getVariableData('BatchCount')-1"/>
            <to variable="BatchCount"/>
          </copy>
        </assign>
      </sequence>
    </while>
    <switch name="Switch4" id="BpSwt4">
      <case condition="bpws:getVariableData('ErrorFlag')='YES'">
        <bpelx:annotation>
          <bpelx:general>
            <bpelx:property name="userLabel">If error occurs</bpelx:property>
          </bpelx:general>
        </bpelx:annotation>
        <sequence name="ErrorEmailSequence" id="BpSeq14">
          <invoke name="InvokeSelectTransactionDetailErrorLogDBAdapter" inputVariable="InvokeSelectTransactionDetailErrorLogDBAdapter_IV" outputVariable="InvokeSelectTransactionDetailErrorLogDBAdapter_OV" partnerLink="SelectTransactionDetailErrorLogDatabsaeAdapterV1" portType="ns20:SelectTransactionDetailErrorLogDatabsaeAdapterV1_ptt" operation="SelectTransactionDetailErrorLogDatabsaeAdapterV1" bpelx:invokeAsDetail="no" id="BpInv17"/>
          <assign name="xformSelectTransactionDetailErrorDesc" id="BpAss28">
            <bpelx:annotation>
              <bpelx:pattern>transformation</bpelx:pattern>
            </bpelx:annotation>
            <copy>
              <from expression="ora:doXSLTransformForDoc('xsl/TransactionErrorDetail_to_EmailErrorDesc.xsl', $InvokeSelectTransactionDetailErrorLogDBAdapter_OV.SelectTransactionDetailErrorLogDatabsaeAdapterV1OutputCollection)"/>
              <to variable="InvokeMergeTrxnDtlErrorLogDBAdapter_IV" part="EngageSoaTxndtlErrorlogCollection"/>
            </copy>
          </assign>
          <assign name="AssignErrorEmailValues" id="BpAss29">
            <copy>
              <from expression="ora:getCompositeInstanceId()"/>
              <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:CommonErrorData/ns22:InstanceID"/>
            </copy>
            <copy>
              <from expression="ora:getNodeValue(bpws:getVariableData('InvokeMergeTransactionDetail_IV','PrtCardTransactionDetailCollection','/ns23:PrtCardTransactionDetailCollection'))"/>
              <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:ErrorDetails/ns22:ErrorDescription"/>
            </copy>
            <copy>
              <from expression="'Unable to process record, record moved to errorlog. Please check errorlog for more details.'"/>
              <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:ErrorDetails/ns22:ErrorSummary"/>
            </copy>
            <copy>
              <from expression="'BE-026'"/>
              <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:ErrorDetails/ns22:ErrorCode"/>
            </copy>
            <copy>
              <from expression="'E008_BE'"/>
              <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:ErrorNotification/ns22:LookupCriteria"/>
            </copy>
            <copy>
              <from expression="&quot;Error in processing records for InterfaceID:E008.&quot;"/>
              <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:ErrorNotification/ns22:Subject"/>
            </copy>
            <copy>
              <from expression="ora:getComponentName()"/>
              <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:CommonErrorData/ns22:ComponentName"/>
            </copy>
            <copy>
              <from expression="'E008'"/>
              <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:CommonErrorData/ns22:ProjectID"/>
            </copy>
            <copy>
              <from expression="'E008TransactionDetailPALStoPortal'"/>
              <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:CommonErrorData/ns22:ProjectName"/>
            </copy>
            <copy>
              <from expression="xp20:current-dateTime()"/>
              <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:CommonErrorData/ns22:Timestamp"/>
            </copy>
            <copy>
              <from variable="ReceiveInvocationMsgIV" part="invocationPayload" query="/ns6:invocationMsg/ns6:SenderSystem"/>
              <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:CommonErrorData/ns22:Source"/>
            </copy>
            <copy>
              <from variable="ReceiveInvocationMsgIV" part="invocationPayload" query="/ns6:invocationMsg/ns6:ReceiverSystem"/>
              <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:CommonErrorData/ns22:Target"/>
            </copy>
            <copy>
              <from variable="ReceiveInvocationMsgIV" part="invocationPayload" query="/ns6:invocationMsg/ns6:UserName"/>
              <to variable="InvokeSOAErrorHandlerJMSQAdapter_IV" part="body" query="/ns22:ErrorInfo/ns22:CommonErrorData/ns22:UserID"/>
            </copy>
          </assign>
          <invoke name="InvokeSOAErrorHandlerJMSQAdapter" inputVariable="InvokeSOAErrorHandlerJMSQAdapter_IV" partnerLink="SOAErrorHandlerJMSQAdapter" portType="ns21:Produce_Message_ptt" operation="Produce_Message" bpelx:invokeAsDetail="no" id="BpInv18"/>
          <assign name="xformUpdateTrxnDtlErrorLog" id="BpAss30">
            <bpelx:annotation>
              <bpelx:pattern>transformation</bpelx:pattern>
            </bpelx:annotation>
            <copy>
              <from expression="ora:doXSLTransformForDoc('xsl/SelectErrorLog_to_UpdateErrorLog.xsl', $InvokeSelectTransactionDetailErrorLogDBAdapter_OV.SelectTransactionDetailErrorLogDatabsaeAdapterV1OutputCollection)"/>
              <to variable="InvokeUpdateTrxnDtlErrorLogDBAdapterV1_IV" part="EngageSoaTxndtlErrorlogCollection"/>
            </copy>
          </assign>
          <invoke name="InvokeUpdateTrxnDtlErrorLogDBAdapterV1" inputVariable="InvokeUpdateTrxnDtlErrorLogDBAdapterV1_IV" partnerLink="UpdateTrxnDtlErrorLogDatabaseAdapterV1" portType="ns24:UpdateTrxnDtlErrorLogDatabaseAdapterV1_ptt" operation="update" bpelx:invokeAsDetail="no" id="BpInv19"/>
        </sequence>
      </case>
      <otherwise>
        <empty name="Empty1" id="BpEmp0"/>
      </otherwise>
    </switch>
  </sequence>
</process><!--
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  Oracle JDeveloper BPEL Designer 
  
  Created: Wed May 14 12:53:11 IST 2014
  Author:  10608609
  Type: BPEL 1.1 Process
  Purpose: Empty BPEL Process
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
-->