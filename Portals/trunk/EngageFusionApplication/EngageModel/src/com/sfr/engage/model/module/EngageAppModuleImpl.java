package com.sfr.engage.model.module;


import com.sfr.engage.model.module.common.EngageAppModule;
import com.sfr.engage.model.queries.rvo.ProductsDisplayRVOImpl;
import com.sfr.engage.model.queries.rvo.PrtAccountRVOImpl;
import com.sfr.engage.model.queries.rvo.PrtCustomerCardMapRVO1Impl;
import com.sfr.engage.model.queries.rvo.PrtGenHelpRVOImpl;
import com.sfr.engage.model.queries.rvo.PrtGenStringRVOImpl;

import com.sfr.engage.model.queries.rvo.PrtPcmFeedsRVOImpl;
import com.sfr.engage.model.queries.uvo.PrtDriverInformationVOImpl;
import com.sfr.engage.model.queries.uvo.PrtTruckInformationVOImpl;

import com.sfr.engage.utility.util.AccessDataControl;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.SQLException;
import java.sql.Statement;

import oracle.jbo.Row;
import oracle.jbo.ViewCriteria;
import oracle.jbo.ViewCriteriaRow;
import oracle.jbo.server.ApplicationModuleImpl;
import oracle.jbo.server.ViewObjectImpl;
// ---------------------------------------------------------------------
// ---    File generated by Oracle ADF Business Components Design Time.
// ---    Thu Mar 06 20:05:06 IST 2014
// ---    Custom code may be added to this class.
// ---    Warning: Do not modify method signatures of generated methods.
// ---------------------------------------------------------------------
public class EngageAppModuleImpl extends ApplicationModuleImpl implements EngageAppModule {
    /**
     * This is the default constructor (do not remove).
     */
    public EngageAppModuleImpl() {
    }

    /**
     * Container's getter for PrtGenStringRVO1.
     * @return PrtGenStringRVO1
     */
    public PrtGenStringRVOImpl getPrtGenStringRVO1() {
        return (PrtGenStringRVOImpl)findViewObject("PrtGenStringRVO1");
    }

    /**
     * Container's getter for ProductsDisplayRVO1.
     * @return ProductsDisplayRVO1
     */
    public ProductsDisplayRVOImpl getProductsDisplayRVO1() {
        return (ProductsDisplayRVOImpl)findViewObject("ProductsDisplayRVO1");
    }


    /**
     * Container's getter for PriceListRVO1.
     * @return PriceListRVO1
     */
    public ViewObjectImpl getPriceListRVO1() {
        return (ViewObjectImpl)findViewObject("PriceListRVO1");
    }


    /**
     * Container's getter for PrtTruckInformationVO1.
     * @return PrtTruckInformationVO1
     */
    public ViewObjectImpl getPrtTruckInformationVO1() {
        return (ViewObjectImpl)findViewObject("PrtTruckInformationVO1");
    }

    /**
     * Container's getter for PrtTruckInformationVO2.
     * @return PrtTruckInformationVO2
     */
    public PrtTruckInformationVOImpl getPrtTruckInformationVO2() {
        return (PrtTruckInformationVOImpl)findViewObject("PrtTruckInformationVO2");
    }
/**
     * Container's getter for PrtDriverInformationVO1.
     * @return PrtDriverInformationVO1
     */
    public ViewObjectImpl getPrtDriverInformationVO1() {
        return (ViewObjectImpl)findViewObject("PrtDriverInformationVO1");
    }


    /**
     * Container's getter for PrtDriverInformationVO2.
     * @return PrtDriverInformationVO2
     */
    public PrtDriverInformationVOImpl getPrtDriverInformationVO2() {
        return (PrtDriverInformationVOImpl)findViewObject("PrtDriverInformationVO2");
    }

    /**
     * Container's getter for PriceListNewRVO1.
     * @return PriceListNewRVO1
     */
    public ViewObjectImpl getPriceListNewRVO1() {
        return (ViewObjectImpl)findViewObject("PriceListNewRVO1");
    }
/**
     * Container's getter for PrtGenHelpVO1.
     * @return PrtGenHelpVO1
     */
    public ViewObjectImpl getPrtGenHelpVO1() {
        return (ViewObjectImpl)findViewObject("PrtGenHelpVO1");
    }

    /**
     * Container's getter for PrtGenHelpRVO1.
     * @return PrtGenHelpRVO1
     */
    public ViewObjectImpl getPrtGenHelpRVO1() {
        return (ViewObjectImpl)findViewObject("PrtGenHelpRVO1");
    }
/**
     * @param accountId
     * @param type
     * @param countryCd
     * @param regDriverValue
     * This method is used to delete Driver/Truck details for the Account.
     */
    public void deleteAllForAccount(String accountId, String type, String countryCd, String regDriverValue ){
        System.out.println("Account Number in Application module===>"+accountId);
        System.out.println("type in application module====>"+type);
        System.out.println("countryCd in application module=====>"+countryCd);
        System.out.println("regDriverValue in apppilcation module====>"+regDriverValue);
        
        Connection con=null;
        PreparedStatement pStmt = null;
        String statement = null;
                try {
                    Statement stmt = getDBTransaction().createStatement(0);
                    con = stmt.getConnection();
                    if(type.equals("driver")){
                        if(regDriverValue!= null){
                        System.out.println("Inside this block of driver in application moule");
                        statement = "DELETE PRT_DRIVER_INFORMATION where ACCOUNT_ID = '"+accountId+"' and COUNTRY_CODE ='"+countryCd+"' and DRIVER_NAME ='"+regDriverValue+"'";
                        }else{
                            System.out.println("Inside else block of driver in application moule");
                        statement = "DELETE PRT_DRIVER_INFORMATION where ACCOUNT_ID = '"+accountId+"' and COUNTRY_CODE ='"+countryCd+"'";
                        }
                    }else{
                        if(regDriverValue!= null){
                        System.out.println("Inside this block of vehicle in application moule");
                        statement = "DELETE PRT_TRUCK_INFORMATION where ACCOUNT_NUMBER = '"+accountId+"' and REGISTRATION_NUMBER ='"+regDriverValue+"'";
                        }else{
                            System.out.println("Inside else block of vehilce in application moule");
                        statement = "DELETE PRT_TRUCK_INFORMATION where ACCOUNT_NUMBER = '"+accountId+"'";
                        }
                    }                    
                   
                    pStmt = con.prepareStatement(statement);   
                    pStmt.executeUpdate();
                    con.commit();
                } catch (SQLException sqle) {
                    sqle.getMessage();
                } finally {
                    try {
                        pStmt.close();
                    } catch (SQLException sqle) {
                        sqle.getMessage();
                    }
                }
    }



    public String getWebServiceErrorMessage(String errorMessage, String countryCode) {
        String translatedValue = "";
        PrtGenStringRVOImpl vo = getPrtGenStringRVO1();
        ViewCriteria vc = vo.createViewCriteria();
        ViewCriteriaRow vcr = vc.createViewCriteriaRow();
        vcr.setAttribute("KeyCode", errorMessage);
        vc.add(vcr);
        vcr.setAttribute("TypeValue", "GENERAL_ERROR_MESSAGE");
        vc.add(vcr);
        vcr.setAttribute("LangCode", countryCode);
        vc.add(vcr);
        vo.applyViewCriteria(vc);
        vo.executeQuery();
        System.out.println("getGeneralErrorMessage Row Count:" + vo.getRowCount());
        while (vo.hasNext()) {
            Row tran = vo.next();
            translatedValue = (String)tran.getAttribute("KeyValue");
        }
        return translatedValue;
    }
/**
     * Container's getter for PrtAccountRVO1.
     * @return PrtAccountRVO1
     */
    public ViewObjectImpl getPrtAccountRVO1() {
        return (ViewObjectImpl)findViewObject("PrtAccountRVO1");
    }

    /**
     * Container's getter for PrtPcmFeedsRVO1.
     * @return PrtPcmFeedsRVO1
     */
    public ViewObjectImpl getPrtPcmFeedsRVO1() {
        return (ViewObjectImpl)findViewObject("PrtPcmFeedsRVO1");
    }

    /**
     * Container's getter for PrtCustomerCardMapRVO1_1.
     * @return PrtCustomerCardMapRVO1_1
     */
    public PrtCustomerCardMapRVO1Impl getPrtCustomerCardMapRVO1_1() {
        return (PrtCustomerCardMapRVO1Impl)findViewObject("PrtCustomerCardMapRVO1_1");
    }
}
